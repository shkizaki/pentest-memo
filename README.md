# pentest-memo
## nmapスキャン
`nmap -sC -sV -oA <filename> <ipaddress>`  
`nmap -p- -sC -sV -oA <filename> <ipaddress>`  
`nmap -Pn -sC -sV -oA <filename> <ipaddress>`  
`nmap -sC -sV -sS -oA <filename> <ipaddress>`  
`nmap -Pn --script vuln <ipaddress>`  

-sC: デフォルトスキャン  
-sV: バージョンスキャン  
-oA: nmapファイル生成  
-p-: フルポート  
-p1-1024: ポートレンジ指定  
-A : OS、バージョン検出  
-Pn: 調査なし  
-sS: TCP SYN ステルススキャン  
-script vuln: 脆弱性調査

## OSINT  
公開情報から攻撃できる可能性を探る  
[OSINTFramework](https://osintframework.com/)  
- ポイント  
  - サイトチェック  
    - 不要なドキュメントのチェック  
    - 想定外の動作チェック  
    - 例えばauthurのadminが露呈していないか  
    - サブドメインの検索  
    - フィッシングサイトの検索  
    - robots.txt  
    - 過去のアーカイブのチェック
    [Weyback Machine](https://archive.org/web/)  
    - 構成情報を取得できるか
    [Wappalyzer](https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg)  
    [builtwith](https://builtwith.com/ja/plans)  
  - SNS  
  　- Githubで不要なソースコードがないか  
　  - Twitterで会社についてつぶやかれていないか  
　  - Facebookで会社情報を暴露されてないか  
　  - LinkedInで社員が拾えるか（リクルーターを装い連絡するなど想定）  
　  - Wantedlyで人材募集広告があるか  
  - ユーザネーム  
    - 有効なユーザがいるか  
    [checkusername](https://checkusernames.com/)  
    - パスワード流出があるか  
    [Have I been pwned](https://haveibeenpwned.com/)  
    [Firefox Monitor](https://monitor.firefox.com/)  
  - メールアドレス  
    - 有効なメールアドレスの確認  
    [Hunter.io](https://hunter.io/)  
    [mailtester](https://mailtester.com/)  
    - MXレコードを検索するサービス  
    [MXToolBox](https://mxtoolbox.com/)  
 
    

### Google Dorks  
 例）site:example.com  
- [Google](https://www.google.com/)  
- [DuckDuckGo](https://duckduckgo.com/)  
- [bing](https://www.bing.com/)  
- [Yahoo](https://www.yahoo.co.jp/)  
└[Tips1](https://moz.com/blog/mastering-google-search-operators-in-67-steps)  
└[Tips2](https://gist.github.com/stevenswafford/393c6ec7b5375d5e8cdc)  
└[Google Hacking Database](https://www.exploit-db.com/google-hacking-database)  

### whois, nslookup, dig  
- [whois.com](https://www.whois.com/)  
- [Domain Tools](http://whois.domaintools.com/) #有償のwhois上位版  
- [whois.jp](https://whois.jp/)  
- [ViewDNS](https://viewdns.info/) #かなり豊富    
`dig <domain> any`#すべてのレコードを返す  
`nslookup`  
└`set type=any` #すべてのレコードを返す  

### Tool
- [ReconNG](https://github.com/lanmaster53/recon-ng)  
参考:https://hackertarget.com/recon-ng-tutorial/  
- [Spiderfoot](https://github.com/smicallef/spiderfoot)#脅威情報を自動で検索収集  
- [theHarverster](https://github.com/laramies/theHarvester) #メールアドレスを収集  
`theHarvester -d microsoft.com -l 500 -b google`  
-d: domain  
-l: limit of search result  
-b: data source  
- [sublist3er](https://github.com/aboul3la/Sublist3r) #Webサイトのサブドメインを列挙  
`python sublist3r.py -d google.com`  
- [DNSRecon] Webサイトのサブドメインを列挙  
`dnsrecon -d example.com -D /usr/share/wordlists/subdomains-top1mil-5000.txt -t brt`
- [Shodan](https://www.shodan.io/) 
- [censys](https://censys.io/)  
サイトがどのように見られているか確認  
- Maltego
関連情報自動検索ツール  
参考  
https://www.maltego.com/categories/tutorial/  
https://medium.com/@raebaker/a-beginners-guide-to-osint-investigation-with-maltego-6b195f7245cc  
http://high-hill.hatenablog.com/entry/2018/06/25/040134  
- [Exploit-DB](https://www.exploit-db.com/)  

##ディレクトリファイル探索
- dirbuster  
- gobuster  
`gobuster dir -u http://10.10.10.187 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q -e`  
`gobuster dir -u http://10.10.10.187/admin-dir/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x html,htm,php,txt`  
- wfuzz  
参考: https://wfuzz.readthedocs.io/en/latest/user/getting.html  
`wfuzz -c -z file,/usr/share/wordlists/wfuzz/general/common.txt --hc 404 http://example.com/admin-dir/FUZZ`  
`wfuzz --hh=24 -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  http://example.com/api/action.php?FUZZ=test`  
